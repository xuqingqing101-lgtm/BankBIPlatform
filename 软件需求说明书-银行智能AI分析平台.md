# 软件需求说明书 - 银行智能AI分析平台

## 1. 引言

### 1.1 编写目的
本文档旨在明确银行智能AI分析平台的功能需求，为后续开发、测试和验收提供依据。

### 1.2 平台定位
全行BI问数平台，支持按角色权限管理的数据分析，提供个性化看板定制能力，实现从"看数据"到"问数据"的转变。

## 2. 核心功能需求

### 2.1 智能问数 (AI RAG & Text-to-SQL)
*   **需求描述**：支持用户使用自然语言查询业务数据，系统自动解析意图并生成SQL或检索知识库，返回准确结果。
*   **功能点**：
    *   **Text-to-SQL**：基于用户上传的结构化数据（CSV/Excel），自动推断Schema，将自然语言转为SQL查询。
        *   支持多表关联查询（如客户表、存款表、贷款表）。
        *   支持聚合查询（求和、平均、计数、分组）。
        *   支持数据类型推断（INT, DOUBLE, DATE, VARCHAR）。
    *   **RAG (检索增强生成)**：基于非结构化文档（知识库），检索相关段落并生成回答。
    *   **防幻觉机制**：
        *   系统提示词强调"严禁编造"，无数据时明确告知。
        *   降低模型温度（Temperature=0.1）。
        *   仅基于查询结果回答。
    *   **多轮对话**：支持上下文记忆，用户可基于上一轮结果继续追问。

### 2.2 数据管理中心
*   **需求描述**：提供自助式数据接入、清洗和建模功能。
*   **功能点**：
    *   **数据上传**：支持 CSV/Excel 文件上传，自动解析表头。
    *   **类型推断**：自动采样前1000行数据，推断字段类型（文本、数值、日期）。
    *   **类型修正**：用户可手动修正推断错误的字段类型。
    *   **数据存储**：将上传数据自动存入 H2 数据库，生成物理表。
    *   **元数据管理**：维护表名、字段名、业务含义（Label）、字段分类（维度/指标）。

### 2.3 业务模块分析
平台预置六大核心业务模块，满足不同角色的分析需求：

1.  **经营管理驾驶舱**
    *   全行核心KPI概览（营收、利润、资产规模）。
    *   分行/支行业绩排名与趋势分析。
    *   关键风险指标监控。

2.  **存款业务分析**
    *   存款规模、结构（定期/活期）、增长趋势分析。
    *   对公/零售存款占比分析。
    *   行业存款分布分析。
    *   **分行维度**：支持按中国银行各省分行（北京、上海、广东、浙江等）查看数据。

3.  **贷款业务分析**
    *   贷款余额、不良率、行业投向分析。
    *   信贷审批效率分析（通过率、审批时长）。
    *   风险预警与资产质量监控。

4.  **中间业务分析**
    *   中间业务收入结构分析。
    *   理财、基金、保险销售数据分析。

5.  **客户画像分析**
    *   360度客户视图（基本信息、资产负债、交易行为）。
    *   客户分层与价值分析。
    *   客户流失预警。

6.  **知识库档案管理**
    *   制度文档、营销话术、产品手册的上传与检索。
    *   支持按角色隔离知识库内容。

### 2.4 个性化看板 ("我的面板")
*   **需求描述**：支持用户将常看的数据卡片或AI分析结果固定到个人看板。
*   **功能点**：
    *   **一键固定**：在对话过程中，可将有价值的图表或结论固定到"我的面板"。
    *   **拖拽布局**：支持自由拖拽卡片位置，调整大小。
    *   **持久化存储**：看板配置本地保存，刷新不丢失。

### 2.5 权限管理
*   **需求描述**：基于角色的访问控制（RBAC），确保数据安全。
*   **角色体系**：
    *   **行长/高管**：全行数据权限。
    *   **部门负责人**：本部门条线数据权限。
    *   **分行/支行行长**：本机构数据权限。
    *   **客户经理**：本人管户数据权限。
*   **数据隔离**：不同角色看到的统计结果范围不同。

## 3. 非功能需求

### 3.1 性能需求
*   AI 响应时间：简单查询 < 3秒，复杂分析 < 10秒。
*   数据上传处理：10万行以内数据秒级入库。

### 3.2 安全需求
*   所有 API 接口需进行身份认证。
*   AI 生成的 SQL 需进行安全审计，防止 SQL 注入。
*   敏感数据脱敏展示。

### 3.3 易用性
*   界面简洁直观，采用现代化 UI 设计（Shadcn/UI）。
*   支持深色/浅色模式切换。
*   关键操作提供 Toast 提示和引导。

## 4. 技术架构

*   **前端**：React + TypeScript + Vite + Tailwind CSS + Shadcn/UI
*   **后端**：Spring Boot 3 + JDK 17
*   **数据库**：H2 Database (嵌入式，支持自动建表)
*   **AI 模型**：DeepSeek-V3 (via HiAgent/DeepSeek API)
*   **ORM**：JPA / Hibernate + JdbcTemplate (动态SQL)

## 5. 附录
*   [API 接口文档](./src/backend/API_QUICK_START.md)
*   [平台定位说明](./src/PLATFORM_POSITIONING.md)
