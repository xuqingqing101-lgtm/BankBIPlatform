# 用户操作手册与测试指南

**文档日期**: 2026-02-13
**适用版本**: V2.0 (含动态 Schema 维护与分模式数据导入)

## 1. 系统启动

### 1.1 启动后端 (Spring Boot)
1. 打开终端，进入 `src/backend` 目录。
2. 执行 Maven 启动命令:
   ```bash
   mvn spring-boot:run
   ```
3. 等待控制台输出 `Started BankBiApplication in ... seconds`，表示后端启动成功（默认端口 8080）。

### 1.2 启动前端 (React)
1. 打开新的终端，进入项目根目录。
2. 安装依赖 (首次运行): `npm install`
3. 启动开发服务器:
   ```bash
   npm run dev
   ```
4. 浏览器访问终端显示的本地地址（通常为 `http://localhost:5173`）。

---

## 2. 数据管理操作指南 (核心功能)

本模块用于将业务数据导入系统，是智能问数和看板展示的基础。

### 2.1 第一步：导入表结构 (Schema)
**目的**: 定义数据库表的结构，或者修改现有表的字段。

1. 进入系统左侧菜单 **"数据管理"** -> **"数据导入"** 标签页。
2. 找到 **"1. 导入表结构 (Schema)"** 卡片。
3. 点击 **"选择Schema"** 按钮，上传符合规范的 Excel/CSV 文件。
   *   *测试文件路径*: `preload/data/new_v2/manual_test/schema_all.csv`
4. 点击 **"导入 Schema"**。
   *   **系统行为**: 后端会根据文件中的配置，自动在数据库中创建表，或根据 `操作类型` (新增/修改/删除) 更新现有表结构。
   *   *注意*: 如果表已存在且操作类型为“新增”，系统会自动忽略建表操作，仅添加新字段。

### 2.2 第二步：导入业务数据
**目的**: 将实际的客户、账户、交易等数据写入已创建的表中。

1. 在 **"2. 导入数据"** 卡片中。
2. 点击 **"选择数据"** 按钮，选择与表名对应的数据文件。
   *   *测试文件路径*: `preload/data/new_v2/manual_test/customer_info.csv` (以客户表为例)
3. **选择导入模式**:
   *   🔴 **全表覆盖**: 点击红色按钮。系统将**清空**该表所有旧数据，仅保留本次上传的数据。适用于全量数据更新。
   *   🟢 **新增数据**: 点击绿色按钮。系统将保留旧数据，将新数据**追加**到表中。适用于增量更新。
4. 导入成功后，左侧 "已上传数据表" 列表中的行数会实时更新。

### 2.3 第三步：数据清洗与打标 (可选)
1. 切换到 **"数据清洗"** 标签页，点击 "重新清洗" 可模拟清洗任务。
2. 切换到 **"数据分类与打标"** 标签页。
   *   左侧选择数据表。
   *   右侧可编辑字段的 **业务标签** (Label)、**字段含义** 和 **字段分类** (维度/指标/时间)。
   *   点击 **"保存配置"**，这些元数据将帮助 AI 更准确地回答用户提问。

--- 

## 3. 智能问数测试指南

**场景**: 验证 Text-to-SQL 功能是否正常。

1. 进入 **"智能助手"** (首页对话框)。
2. **测试用例 1 (基础查询)**:
   *   输入: "查询所有存款余额大于 50000 的客户姓名"
   *   *预期*: 系统返回表格，列出符合条件的客户姓名和余额。
3. **测试用例 2 (聚合统计)**:
   *   输入: "统计各分行的存款总额"
   *   *预期*: 系统返回柱状图或饼图，显示各分行名称及对应的总金额。
4. **测试用例 3 (多表关联)**:
   *   输入: "查询张三名下的所有贷款记录及状态"
   *   *预期*: 系统自动关联 `customer_info` 和 `account_loan` 表，返回结果。

---

## 4. 知识库问答测试指南

**场景**: 验证 RAG (检索增强生成) 功能。

1. 进入 **"知识库"** 模块。
2. 上传一份测试文档（如简单的 TXT 文件，内容为 "本行大额存单起存金额为 20 万元"）。
3. 回到 **"智能助手"**。
4. 提问: "大额存单的起存金额是多少？"
5. *预期*: AI 能够准确回答 "20 万元"，并可能引用上传的文档作为来源。

---

## 5. 常见问题排查

*   **Q: 导入数据时提示 "表不存在"？**
    *   A: 请先执行 "导入 Schema" 步骤，确保数据库中已创建了对应的表结构。
*   **Q: 全表覆盖后数据丢失？**
    *   A: "全表覆盖" 会执行 `TRUNCATE` 操作，这是设计预期的行为。如需保留旧数据，请使用 "新增数据" 按钮。
*   **Q: 图表无法显示？**
    *   A: 请检查数据列是否正确打标，AI 需要通过 "指标" 和 "维度" 标签来决定图表类型。

---

**测试数据资源**:
所有测试所需文件均位于项目目录 `preload/data/new_v2/manual_test/` 下，请优先使用此目录下的文件进行验证。
