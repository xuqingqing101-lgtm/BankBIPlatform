# 下钻分析功能说明

## 🎯 功能概述

为DrillDownPage增加了多层级的下钻分析功能，用户可以通过点击表格中的行业、客户或信用等级，查看更详细的细分数据和深度分析。

## ✨ 新增功能

### 1. 可点击的表格行
所有表格行都支持点击进入下钻页面：
- **行业名称** - 查看细分领域分布
- **客户名称** - 查看客户详细信息
- **信用等级** - 查看该等级客户群体分析

### 2. 下钻提示卡片
在页面顶部添加了醒目的提示卡片，告知用户可以点击进行下钻分析。

### 3. 操作按钮
每个可下钻的行都有"查看详情"按钮，不同类型使用不同颜色：
- 🔵 行业分析 - 蓝色
- 🟢 客户分析 - 绿色
- 🟣 信用等级 - 紫色

## 📊 下钻数据类型

### 一、行业下钻（资产/贷款页面）

#### 1. 制造业详情
**KPI指标：**
- 贷款余额：8520亿 (+12.5%)
- 不良率：1.45% (+0.15%)
- 客户数量：1,258户 (+85户)
- 平均利率：4.35% (-0.10%)

**细分领域：**
- 高端装备制造：2850亿（33.5%）- 不良率0.85%
- 新能源汽车：2120亿（24.9%）- 不良率1.12%，增长25.3%
- 电子信息：1680亿（19.7%）- 不良率1.35%
- 传统制造：1250亿（14.7%）- 不良率2.45%
- 其他：620亿（7.3%）

**重点客户列表：**
- 某新能源科技公司：125亿（AAA级）
- 某智能制造企业：98亿（AA+级）
- 某半导体公司：87亿（AA级）
- 某机械制造集团：76亿（AA-级）
- 某精密仪器公司：65亿（A+级）

**图表展示：**
- 柱状图：金额和增长率对比
- 详细表格：包含不良率和增长率
- 风险分析：行业综合评价

#### 2. 房地产详情
**KPI指标：**
- 贷款余额：7680亿 (+3.2%)
- 不良率：2.18% (+0.35%)
- 客户数量：387户 (-12户)
- 平均利率：5.15% (+0.25%)

**细分领域：**
- 优质房企：4992亿（65.0%）- 不良率0.85%
- 区域性房企：1843亿（24.0%）- 不良率3.25%
- 城市更新：614亿（8.0%）- 不良率1.15%
- 其他：230亿（3.0%）- 不良率5.85%

**风险分析：**
房地产行业整体承压，需严控风险敞口，重点支持优质房企和城市更新项目，警惕区域性房企流动性风险。

#### 3. 个人住房贷款详情
**KPI指标：**
- 贷款余额：6520亿 (+8.9%)
- 不良率：0.52% (+0.02%)
- 客户数量：128.5万户 (+8.2万户)
- 平均利率：4.75% (-0.15%)

**城市分布：**
- 一线城市：3260亿（50%）- 不良率0.35%，户均285万
- 二线城市：2280亿（35%）- 不良率0.58%，户均165万
- 三四线城市：980亿（15%）- 不良率0.85%，户均95万

**年龄分布：**
- 25-30岁：1565亿（24%）- 不良率0.45%
- 31-40岁：3260亿（50%）- 不良率0.38%
- 41-50岁：1304亿（20%）- 不良率0.62%
- 50岁以上：391亿（6%）- 不良率0.95%

**特色可视化：**
- 城市分布卡片：每个城市独立卡片展示
- 年龄分布柱状图
- 风险热力图

### 二、客户下钻（存款页面）

#### 某国有企业集团详情
**客户概况：**
- 存款总额：856亿
- 存款类型：对公定期
- 期限：3个月
- 信用评级：AAA
- 合作年限：15年

**存款趋势图：**
- 6个月活期/定期/总额趋势
- 组合图：面积图+柱状图
- 显示资金流动性变化

**产品持有情况：**
| 产品名称 | 余额(亿) | 利率 | 状态 |
|---------|---------|------|------|
| 对公定期存款 | 594 | 2.85% | 持有中 |
| 对公活期存款 | 262 | 0.35% | 持有中 |
| 结构性存款 | 0 | - | 未持有 |
| 协议存款 | 0 | - | 未持有 |

**客户分析：**
该客户为优质国企客户，存款规模大且稳定，以定期存款为主，可以进一步营销结构性存款等高收益产品。

### 三、信用等级下钻（贷款页面）

#### AAA级客户群体
**KPI指标：**
- 贷款余额：15,200亿 (+8.5%)
- 客户数量：856户 (+45户)
- 不良率：0.12% (+0.01%)
- 平均利率：3.85% (-0.05%)

**行业分布：**
- 基础设施：4560亿（30%）- 125户
- 制造业：3800亿（25%）- 215户
- 金融服务：2736亿（18%）- 78户
- 能源电力：2280亿（15%）- 95户
- 其他：1824亿（12%）- 343户

**饼图+表格：**
- 饼图显示行业占比
- 表格显示详细数据和客户数量

**重点客户：**
- 某中央企业集团：850亿 - 高风险敞口
- 某国有银行：680亿 - 中风险敞口
- 某电力集团：520亿 - 中风险敞口
- 某通信运营商：450亿 - 中风险敞口
- 某汽车制造集团：380亿 - 低风险敞口

**综合分析：**
AAA级客户是银行最优质的客户群体，违约风险极低，但利率水平也相对较低，需要通过综合金融服务提升收益。

#### BBB级客户群体
**KPI指标：**
- 贷款余额：2,890亿 (+5.2%)
- 客户数量：425户 (-18户)
- 不良率：2.45% (+0.35%)
- 平均利率：5.65% (+0.25%)

**行业分布：**
- 批发零售：1012亿（35%）
- 制造业：867亿（30%）
- 房地产：578亿（20%）
- 其他：433亿（15%）

**重点关注客户表：**
| 客户名称 | 余额(亿) | 行业 | 风险分类 | 关注原因 |
|---------|---------|------|---------|----------|
| 某传统制造企业 | 85 | 制造业 | 关注类 | 市场需求下滑 |
| 某批发贸易公司 | 68 | 批发零售 | 关注类 | 现金流紧张 |
| 某区域房企 | 52 | 房地产 | 次级 | 债务重组中 |

**风险提示：**
BBB级客户风险相对较高，需加强贷后管理和风险监控，适当提高利率水平以覆盖风险成本。

## 🎨 子页面设计

### 页面结构
```
┌─────────────────────────────────────┐
│ 头部：标题 + "深度分析"标签 + 返回按钮   │
├─────────────────────────────────────┤
│ KPI 指标卡片（2-4列网格）              │
├─────────────────────────────────────┤
│ 细分领域分布（图表+表格）              │
├─────────────────────────────────────┤
│ 行业/城市分布（饼图+表格）             │
├─────────────────────────────────────┤
│ 重点客户列表                          │
├─────────────────────────────────────┤
│ 风险客户表（仅BBB级）                 │
├─────────────────────────────────────┤
│ 趋势图表（仅客户详情）                │
├─────────────────────────────────────┤
│ 产品持有（仅客户详情）                │
├─────────────────────────────────────┤
│ 综合分析卡片                          │
└─────────────────────────────────────┘
```

### 视觉标识
- **深度分析标签**：紫色 (purple-500)
- **行业下钻按钮**：蓝色 (blue-400)
- **客户下钻按钮**：绿色 (green-400)
- **等级下钻按钮**：紫色 (purple-400)
- **风险提示卡片**：红色左边框
- **综合分析卡片**：蓝色/绿色左边框

### 图表类型
1. **柱状图**：细分领域金额和增长率对比
2. **饼图**：行业占比分布
3. **组合图**：存款趋势（面积图+柱状图）
4. **卡片网格**：城市分布独立卡片

## 🚀 交互流程

### 1. 进入下钻页面
```
主页面 → 点击表格行 → 子页面加载
```

### 2. 返回主页面
```
子页面 → 点击返回按钮 → 回到主页面
```

### 3. 导航路径
```
资产详情 → 制造业详情 → 查看具体客户（未来可扩展）
存款详情 → 客户详情 → 查看交易记录（未来可扩展）
贷款详情 → AAA客户 → 查看具体客户（未来可扩展）
```

## 💡 数据关联

### 行业ID映射
```typescript
{
  manufacturing: '制造业详细数据',
  realestate: '房地产详细数据',
  housing: '个人住房详细数据',
  wholesale: '批发零售详细数据',
  infrastructure: '基础设施详细数据',
  consumer: '消费贷款详细数据'
}
```

### 客户ID映射
```typescript
{
  corp1: '某国有企业集团',
  corp2: '某市政府财政账户',
  corp3: '某上市公司',
  corp4: '某投资基金',
  retail1: '高净值客户群体'
}
```

### 评级ID映射
```typescript
{
  aaa: 'AAA级客户群体',
  aa: 'AA级客户群体',
  a: 'A级客户群体',
  bbb: 'BBB级客户群体',
  bb: 'BB及以下客户群体'
}
```

## 🎯 使用场景

### 场景1：行业风险分析
**需求**：分析制造业贷款的风险分布
**操作**：资产详情 → 点击"制造业" → 查看细分领域 → 识别高风险子行业

### 场景2：重点客户管理
**需求**：了解某大客户的存款结构和趋势
**操作**：存款详情 → 点击"某国有企业集团" → 查看存款趋势和产品持有

### 场景3：信用风险监控
**需求**：监控BBB级客户的风险状况
**操作**：贷款详情 → 点击"BBB" → 查看重点关注客户列表 → 识别高风险客户

### 场景4：市场机会发掘
**需求**：寻找新能源领域的业务机会
**操作**：资产详情 → 点击"制造业" → 查看细分领域 → "新能源汽车"增长25.3%

## 📊 数据洞察

### 制造业
- ✅ 新能源汽车增长最快（25.3%）
- ✅ 高端装备占比最大（33.5%）
- ⚠️ 传统制造不良率较高（2.45%）

### 房地产
- ✅ 优质房企占比65%，风险可控
- ⚠️ 区域性房企不良率3.25%
- ⚠️ 客户数量下降12户

### 个人住房
- ✅ 31-40岁客户占比50%，质量最优
- ✅ 一线城市不良率仅0.35%
- ⚠️ 三四线城市不良率0.85%

### AAA客户
- ✅ 客户数量增长45户
- ✅ 不良率极低0.12%
- 💡 利率较低，需提升综合收益

### BBB客户
- ⚠️ 客户数量减少18户
- ⚠️ 不良率2.45%，需重点监控
- 💰 利率5.65%，风险溢价较高

## 🎉 功能亮点

1. **🔍 多层级下钻** - 从总览到细节，层层递进
2. **📊 丰富图表** - 柱状图、饼图、组合图、卡片网格
3. **🎯 精准定位** - 快速找到关注的行业/客户/等级
4. **⚠️ 风险预警** - 重点关注客户红色标识
5. **💡 智能建议** - 每个页面都有综合分析
6. **🎨 视觉区分** - 不同类型使用不同颜色
7. **📈 趋势追踪** - 存款、贷款变化趋势
8. **🔄 灵活导航** - 轻松返回上级页面

## 🔮 未来扩展

1. **更深层级下钻** - 从客户到具体交易记录
2. **横向对比** - 同行业不同客户对比
3. **时间序列分析** - 查看历史数据变化
4. **预测分析** - 基于历史数据预测未来趋势
5. **关联分析** - 发现客户之间的关联关系
6. **导出功能** - 导出下钻页面的详细报告

## 📝 技术实现

### 状态管理
```typescript
const [subPage, setSubPage] = useState<any>(null);
```

### 下钻触发
```typescript
const handleItemClick = (itemId: string, type: 'industry' | 'customer' | 'rating') => {
  const drillData = getDrillDownData(itemId, type);
  setSubPage(drillData);
};
```

### 页面切换
```typescript
if (subPage) {
  return <SubPage data={subPage} onBack={() => setSubPage(null)} />;
}
```

## 🎊 总结

下钻分析功能让用户可以从宏观到微观，从总览到细节，逐层深入了解业务数据。通过直观的可视化和详细的数据表格，帮助决策者快速发现问题、识别机会、制定策略。真正实现了"一钻到底"的数据探索体验！
